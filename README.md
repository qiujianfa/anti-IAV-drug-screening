# anti-IAV-drug-screening
The codes of functional genomic- and pharmacotranscriptomic-based host-directed anti-IAV drug screening approach.

1. count.sh is an example script that uses MAGeCK to quantify sgRNA read counts from a pooled CRISPR screening dataset (using project PRJNA930886 from the Sequence Read Archive (SRA) database (https://www.ncbi.nlm.nih.gov/sra) as an example).
2. mageck.sh is an example script that uses MAGeCK to calculate the functional importance of each gene by comparing the experimental pool to the reference pool from the output file of 1. count.sh. Each screening round or biological repeat were calculate separately instead of analyzing the repeats or rounds together in an experimental group.
3. functional_ranking_aggregation.R is the R script that analyse the robust gene functional ranking (use the R package RobustRankAggreg) from multiple independent functional screening datasets using the outputs of 2. mageck.sh. For each output of 2. mageck.shmageck.sh, the gene functional importance were identified by the enrichment score and the context of the screening strategy (pro or anti-viral). The pro-IAV factor screening and anti-IAV factor screening were analyzed using RRA algorithm respectively, which produced one pro-IAV score and one anti-IAV score for each gene. Finally, the functional score of each gene against IAV infection was defined as the Anti-IAV score minus pro-IAV score.
4. Anti_IAV_drug_Screening.R is the R script for anti-IAV drug screening in our study using the functional score from 3. functional_ranking_aggregation.R and the L1000 datasets from cMAP database.
